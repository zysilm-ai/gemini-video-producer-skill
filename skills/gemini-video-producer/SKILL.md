---
name: flow-video-producer
description: Produces AI videos using Google Flow via MCP Playwright. Creates promotional, narrative, educational, or social media videos of any length by chaining 8-second segments using keyframe-driven Video aus Frames for seamless continuity. Use when users want to create videos, need video storyboarding, or want AI-generated video content.
---

# Flow Video Producer

Create AI videos of any length using Google Flow. Videos are broken into scenes and 8-second segments, with each segment generated by interpolating between start and end keyframe images.

## Architecture

```
MAIN AGENT (this skill)
    │
    ├── reference-generator  → Subject/character/background images (for style consistency)
    ├── keyframe-generator   → Start & end keyframes for each segment
    └── segment-generator    → Video segments (Video aus Frames with keyframes)
```

Sub-agents are spawned via Task tool. Each has fresh context and returns status JSON.

## Core Concept: Keyframe-Driven Video Generation

**Problem:** Each video generation is stateless - no memory of camera trajectory or subject identity.

**Solution:** Use **Video aus Frames** with explicit start and end keyframes:
- Start keyframe: Opening composition of the segment
- End keyframe: Closing composition of the segment
- Flow interpolates between them based on motion prompt
- End keyframe of segment N = Start keyframe of segment N+1 (for extend-type segments)

| Segment Type | Start Keyframe | End Keyframe |
|--------------|----------------|--------------|
| `initial` | Generate new | Generate new |
| `extend` | Previous segment's end keyframe | Generate new |

## Workflow

### Phase 0: Setup
Navigate to `https://labs.google/fx/flow`, verify login.

### Phase 1: Philosophy
Create `philosophy.md` and `style.json`. See [reference/templates.md](reference/templates.md).

**Get user approval.**

### Phase 2: Scene Breakdown
Create `scene-breakdown.md` with scenes and segments. See [reference/templates.md](reference/templates.md).

**Get user approval.**

### Phase 3: Pipeline
Create `pipeline.json`. See [reference/pipeline-schema.md](reference/pipeline-schema.md).

**Get user approval.**

### Phase 4: References
Spawn `reference-generator` for each reference (parallel):

```
Task(
  subagent_type="reference-generator",
  prompt='Generate reference. Task: {"type": "reference", "reference_id": "...", ...}',
  description="Generate [name] reference"
)
```

Types: `reference` (isolated subject), `character`, `object`, `background`

References are used for style/subject consistency when generating keyframes.

**Get user approval.**

### Phase 5: Keyframes
Spawn `keyframe-generator` for each required keyframe:

**For initial-type segments:** Generate BOTH start_keyframe AND end_keyframe
**For extend-type segments:** Only generate end_keyframe (start = previous segment's end)

```
# Initial segment - generate both keyframes
Task(
  subagent_type="keyframe-generator",
  prompt='Generate keyframe. Task: {"keyframe_id": "seg-01-A-start", "segment_id": "seg-01-A", "scene_id": "scene-01", "keyframe_type": "start", "prompt": "...", ...}',
  description="Generate seg-01-A start keyframe"
)

Task(
  subagent_type="keyframe-generator",
  prompt='Generate keyframe. Task: {"keyframe_id": "seg-01-A-end", "segment_id": "seg-01-A", "scene_id": "scene-01", "keyframe_type": "end", "prompt": "...", ...}',
  description="Generate seg-01-A end keyframe"
)

# Extend segment - only generate end keyframe
Task(
  subagent_type="keyframe-generator",
  prompt='Generate keyframe. Task: {"keyframe_id": "seg-01-B-end", "segment_id": "seg-01-B", "scene_id": "scene-01", "keyframe_type": "end", "prompt": "...", ...}',
  description="Generate seg-01-B end keyframe"
)
```

**Get user approval.**

### Phase 6: Segments
All segments use unified Video aus Frames approach:

```
# Every segment uses the same approach
Task(
  subagent_type="segment-generator",
  prompt='Generate segment. Task: {"segment_id": "seg-01-A", "scene_id": "scene-01", "motion_prompt": "...", "start_keyframe_path": "...", "end_keyframe_path": "...", "output_video_path": "...", "project_dir": "..."}',
  description="Generate seg-01-A"
)
```

**For extend-type segments:** Use the previous segment's end_keyframe as start_keyframe_path.

Segments within a scene must be generated sequentially (each depends on previous segment's end keyframe for continuity checking). Different scenes can be generated in parallel.

**Get user approval.**

### Phase 7: Concatenation
Use `scripts/merge_videos.py`:

```bash
# Merge segments into scene
python scripts/merge_videos.py -o scene-01/scene.mp4 scene-01/seg-A.mp4 scene-01/seg-B.mp4

# Merge scenes into final
python scripts/merge_videos.py -o output.mp4 scene-01/scene.mp4 scene-02/scene.mp4
```

## Rules

1. **Always use TodoWrite** to track progress
2. **Never skip phases** - complete in order
3. **Always get user approval** before proceeding to next phase
4. **Never generate without pipeline.json** - plan first, execute second
5. **Use sub-agents for generation** - reference-generator, keyframe-generator, segment-generator
6. **Update pipeline.json** after each sub-agent returns

## Sub-Agents

### reference-generator
Generates images for visual style consistency.
- **Types:** reference (isolated), character, object, background
- **Input:** type, reference_id, subject_name, prompt, output_path, style_context
- **Uses:** Flow "Bild erstellen" mode
- **Purpose:** Style/subject consistency when generating keyframes

### keyframe-generator
Generates start and end keyframe images for segments.
- **Types:** start (segment opening), end (segment closing)
- **Input:** keyframe_id, segment_id, scene_id, keyframe_type, prompt, output_path, style_context
- **Uses:** Flow "Bild erstellen" mode
- **Purpose:** Define explicit visual anchors for Video aus Frames

### segment-generator
Generates 8-second video segments via Video aus Frames.
- **Input:** segment_id, scene_id, motion_prompt, start_keyframe_path, end_keyframe_path, output_video_path, project_dir
- **Uses:** Flow "Video aus Frames" mode with Veo 3.1 Quality
- **Purpose:** Interpolate between keyframes to create video segment

## Flow Settings

When configuring Flow (via Settings button):
- **Model:** Veo 3.1 - Quality (NOT Fast)
- **Outputs:** 1 (NOT 2)
- **Aspect:** 16:9 Landscape

## Output Structure

```
output/{project}/
├── philosophy.md
├── style.json
├── scene-breakdown.md
├── pipeline.json
├── output.mp4              ← FINAL VIDEO
├── references/
├── scene-01/
│   ├── keyframes/
│   │   ├── seg-A-start.png
│   │   ├── seg-A-end.png
│   │   └── seg-B-end.png   (seg-B-start = seg-A-end)
│   ├── seg-A.mp4
│   ├── seg-B.mp4
│   └── scene.mp4
└── scene-02/
    └── ...
```

## References

- **Pipeline schema:** [reference/pipeline-schema.md](reference/pipeline-schema.md)
- **Veo prompts:** [reference/veo-prompts.md](reference/veo-prompts.md)
- **Templates:** [reference/templates.md](reference/templates.md)
